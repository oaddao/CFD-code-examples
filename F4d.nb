(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28098,        729]
NotebookOptionsPosition[     26105,        696]
NotebookOutlinePosition[     26501,        712]
CellTagsIndexPosition[     26458,        709]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b4eaf46f-7f99-4b5f-b5dd-2c2436f00ad4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HSk", "[", "kx_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"t1", "+", 
       RowBox[{"t2", " ", 
        RowBox[{"Cos", "[", "kx", "]"}]}]}], ")"}], 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
    RowBox[{"t2", " ", 
     RowBox[{"Sin", "[", "kx", "]"}], 
     RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Mu]"}], " ", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"Sin", "[", "kx", "]"}]}]}], ")"}], 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], "-", 
    RowBox[{"I", " ", "\[Gamma]", " ", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.970001226435006*^9, 3.9700012325290327`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"48f2e14c-50bb-4e16-944d-eee860ce830f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HBx", "[", "kx_", "]"}], ":=", 
    RowBox[{
     RowBox[{"tx", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Cos", "[", "kx", "]"}]}], ")"}], 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
     RowBox[{"tx", "  ", 
      RowBox[{"Sin", "[", "kx", "]"}], 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Mu]2"}], "-", 
        RowBox[{"I", " ", "\[Gamma]"}]}], " ", ")"}], 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], ";", 
   RowBox[{
    RowBox[{"HBk", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"HBx", "[", "kx", "]"}], "+", 
     RowBox[{"2", "ty", " ", 
      RowBox[{"Cos", "[", "ky", "]"}], 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.970001233977189*^9, 3.97000123712093*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f28b7ea3-5e66-4067-a97b-87304d51177e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T0", "[", "kx_", "]"}], ":=", 
    RowBox[{"HBx", "[", "kx", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T1", "[", "kx_", "]"}], ":=", 
    RowBox[{"ty", " ", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tm1", "[", "kx_", "]"}], ":=", 
    RowBox[{"ty", " ", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HBr", "[", 
      RowBox[{"kx_", ",", "Ly_"}], "]"}], ":=", 
     RowBox[{"Normal", "[", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Band", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], "->", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], ",", 
          RowBox[{"T1", "[", "kx", "]"}]}], "]"}], "+", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Band", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], "->", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], ",", 
          RowBox[{"Tm1", "[", "kx", "]"}]}], "]"}], "+", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Band", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], "->", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ly", ",", "Ly"}], "}"}]}], "]"}], ",", 
          RowBox[{"T0", "[", "kx", "]"}]}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SelfEne", "[", 
      RowBox[{"omega_", ",", "kx_", ",", "ny_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"t3", "^", "2"}], "*", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{
             RowBox[{"omega", " ", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"ny", "*", "2"}], "]"}]}], "-", 
             RowBox[{"HBr", "[", 
              RowBox[{"kx", ",", "ny"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9700012413814754`*^9, 3.970001251122903*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"ceddbec9-a7d2-4cf8-a50b-7408391ec6b2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GSk", "[", 
      RowBox[{"omega_", ",", "kx_", ",", "ny_"}], "]"}], ":=", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"omega", " ", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
       RowBox[{"HSk", "[", "kx", "]"}], "-", 
       RowBox[{"SelfEne", "[", 
        RowBox[{"omega", ",", "kx", ",", "ny"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.970001256936051*^9, 3.9700012621212883`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"ea83d68d-3676-4e17-ba55-09c5095c901a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tx", "=", "1"}], ";", 
  RowBox[{"ty", "=", "3.5"}], ";", 
  RowBox[{"\[Mu]2", "=", "0.3"}], ";", 
  RowBox[{"\[Gamma]", " ", "=", "0.1"}], ";", 
  RowBox[{"ny", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t3", "=", "0.6"}], ";"}]}], "Input",
 CellChangeTimes->{3.9445297675282965`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"24737c32-5b94-4d0f-b7d3-a979b1702144"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", "1.2"}], ";", 
  RowBox[{"t2", "=", 
   RowBox[{"-", "1"}]}], ";", 
  RowBox[{"\[Mu]", "=", "0.2"}], ";", 
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ESk1", "[", "kx_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t1", "+", 
        RowBox[{"t2", " ", 
         RowBox[{"Cos", "[", "kx", "]"}]}]}], ")"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t2", " ", 
        RowBox[{"Sin", "[", "kx", "]"}]}], ")"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Mu]"}], " ", "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"Sin", "[", "kx", "]"}]}]}], ")"}], "^", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ESk2", "[", "kx_", "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t1", "+", 
         RowBox[{"t2", " ", 
          RowBox[{"Cos", "[", "kx", "]"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t2", " ", 
         RowBox[{"Sin", "[", "kx", "]"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], " ", "+", 
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"Sin", "[", "kx", "]"}]}]}], ")"}], "^", "2"}]}], "]"}]}]}],
   ";"}]}], "Input",
 CellChangeTimes->{3.9700012674365983`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"2c1e12d4-ef2c-42e6-a659-f1767c569a81"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GSkapp", "[", 
     RowBox[{"omega_", ",", "kx_", ",", "ny_"}], "]"}], ":=", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"omega", " ", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", 
      RowBox[{"HSk", "[", "kx", "]"}], "-", 
      RowBox[{"SelfEne", "[", 
       RowBox[{"0", ",", "0", ",", "ny"}], "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.9700012706643496`*^9, 3.9700012727632127`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"e59a3506-1e39-449c-8f48-97b68649e742"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SE2", "[", "kx_", "]"}], ":=", 
   RowBox[{"SelfEne", "[", 
    RowBox[{"4", ",", "kx", ",", "ny"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EV1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Eigenvalues", "[", 
       RowBox[{
        RowBox[{"HSk", "[", "kx", "]"}], "+", 
        RowBox[{"SE2", "[", "kx", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", 
        RowBox[{"-", "Pi"}], ",", "Pi", ",", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "80"}]}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9441926487588778`*^9, {3.9484149265024834`*^9, 3.9484149374739265`*^9}, {
   3.948415403775038*^9, 3.948415405367446*^9}, 3.9484154801829586`*^9, 
   3.9484155506739044`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"4d3a9b87-fb03-44e1-9bfd-fe3175dfe8db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A3a", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"ReIm", "[", "EV1", "]"}], ",", 
     RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Graphics", "/@", 
         RowBox[{"{", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], "}"}]}], ",", 
        "0.02"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Black", ",", 
        RowBox[{"Thickness", "[", "0.15", "]"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.2"}], ",", 
          RowBox[{"-", "0.05"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",", 
        "25", ",", 
        RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}], ",", "25"}], 
       "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<Im \[Omega]\>\"", ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Re \[Omega]\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.20"}], ",", "\"\<-0.20\>\""}], "}"}], ",", 
            RowBox[{"-", "0.15"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.10"}], ",", "\"\<-0.10\>\""}], "}"}], ",", 
            RowBox[{"-", "0.05"}]}], "}"}], ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "390"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9441927735022326`*^9, 3.9441927736824727`*^9}, {
   3.9441933717613745`*^9, 3.944193371942731*^9}, {3.9441934350858192`*^9, 
   3.9441935181166797`*^9}, {3.9443417937444344`*^9, 
   3.9443417968413496`*^9}, {3.9443419845995083`*^9, 3.94434202329177*^9}, {
   3.944342084217424*^9, 3.9443420864764194`*^9}, {3.9443430293146143`*^9, 
   3.94434305700163*^9}, {3.9444418367697744`*^9, 3.9444418382607255`*^9}, 
   3.9484152922491746`*^9, {3.948415749889155*^9, 3.948415757285918*^9}, {
   3.948941293062595*^9, 3.9489413104051776`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1345b085-ca4c-4352-9504-769363700723"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {GrayLevel[0], PointSize[0.009166666666666668], Thickness[0.15], CapForm[
    "Butt"], 
    StyleBox[GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[CircleBox[{0, 0}, 1]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[0.009166666666666668], 
           CapForm["Butt"], 
           AbsoluteThickness[1.6], FontFamily -> "Times New Roman", 
           GrayLevel[0], 
           Thickness[0.15]]}],
        TraditionalForm], {0., 0.}, Automatic, Scaled[0.02]], CompressedData["
1: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
      "]],
     FontFamily->"Times New Roman"]}, {{}, {}}},
  AspectRatio->1,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, -0.05},
  BaseStyle->{FontFamily -> "Times New Roman", 25},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox["\"Im \[Omega]\"", TraditionalForm], None}, {
     FormBox["\"Re \[Omega]\"", TraditionalForm], None}},
  FrameStyle->Automatic,
  FrameTicks->{{{{-0.2, 
       FormBox["\"-0.20\"", TraditionalForm]}, {-0.15, 
       FormBox[
        RowBox[{"-", "0.15`"}], TraditionalForm]}, {-0.1, 
       FormBox["\"-0.10\"", TraditionalForm]}, {-0.05, 
       FormBox[
        RowBox[{"-", "0.05`"}], TraditionalForm]}}, Automatic}, {
    Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->390,
  LabelStyle->{FontFamily -> "Times New Roman", 25, 
    GrayLevel[0]},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{-3, 3}, {-0.2, -0.05}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.948415575237239*^9, 3.9484157657571306`*^9, 3.9489219247742357`*^9, {
   3.948940533394745*^9, 3.9489405552506557`*^9}, 3.9489407449031963`*^9, 
   3.948941103957733*^9, {3.9489412946115227`*^9, 3.948941313352284*^9}, 
   3.9700013120856*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"b6b32ece-c909-4295-be96-9c497bb2df6b"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.9484155739728103`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"c6eb90e2-4303-46f4-acfc-d06dc2ab1f3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cAkapp", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Im", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"w1", "+", 
           RowBox[{"I", " ", "w2"}], "-", 
           RowBox[{"EV1", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "EV1", "]"}]}], "}"}]}], "]"}], "]"}]}], "/", 
    RowBox[{"(", 
     RowBox[{"Pi", "*", 
      RowBox[{
       RowBox[{"Length", "[", "EV1", "]"}], "/", "2"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[473]:=",ExpressionUUID->"93061404-95b6-43b9-b963-f485d7f98677"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Col1", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", ">", "0"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "/", "5"}], ")"}], "^", "1"}]}], "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "0", ",", "1", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x"}], "/", "5"}], ")"}], "^", "1"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[429]:=",ExpressionUUID->"6488790d-3de0-4b0e-b658-efc64711adbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Col1", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "scaledX", "}"}], ",", 
     RowBox[{
      RowBox[{"scaledX", "=", 
       RowBox[{"Rescale", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", ">", "0"}], ",", 
        RowBox[{"DeepRedGradient", "[", "scaledX", "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"For", " ", "x"}], ">", "0"}], ",", 
          RowBox[{"use", " ", "RustTones"}]}], "*)"}], 
        RowBox[{"DeepBlueGradient", "[", 
         RowBox[{"-", "scaledX"}], "]"}]}], "  ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"For", " ", "x"}], "<", "0"}], ",", 
         RowBox[{"use", " ", "DeepSeaColors"}]}], "*)"}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9489218907185435`*^9, 3.948921890720599*^9}, {
   3.9489241966178503`*^9, 3.9489241984572926`*^9}, {3.9489242514233074`*^9, 
   3.9489242552679696`*^9}, {3.9489244356784973`*^9, 3.948924489635545*^9}, {
   3.9489245842473116`*^9, 3.948924585158157*^9}, {3.9489246711733294`*^9, 
   3.948924672928114*^9}, {3.9489247457510223`*^9, 3.948924747272318*^9}, {
   3.948924801002513*^9, 3.9489248030782404`*^9}, {3.9489248628632126`*^9, 
   3.9489248645260706`*^9}, {3.948925164425667*^9, 3.9489252925762167`*^9}, {
   3.948925431333144*^9, 3.94892545089835*^9}, {3.9489400646573257`*^9, 
   3.948940072011159*^9}, {3.9489401435408907`*^9, 3.9489401525876584`*^9}, {
   3.948940442247814*^9, 3.9489404455955267`*^9}, 3.948940789488132*^9},
 CellLabel->
  "In[481]:=",ExpressionUUID->"d8dd481c-3876-4dee-925d-98731fde896c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CK1", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{"cAkapp", ",", 
     RowBox[{"{", 
      RowBox[{"w2", ",", 
       RowBox[{"-", "0.2"}], ",", 
       RowBox[{"-", "0.05"}], ",", 
       RowBox[{"0.15", "/", "1000"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"w1", ",", 
       RowBox[{"-", "3"}], ",", "3", ",", 
       RowBox[{"6", "/", "1000"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.94444185046793*^9, 3.9444418562963486`*^9}, {
  3.948415811767907*^9, 3.9484158158939195`*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"0d3dedf8-526c-47cf-9a85-a12508cdb5ab"],

Cell[BoxData[
 RowBox[{"A3b", "=", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{"CK1", ",", 
    RowBox[{"ColorFunction", "->", "Col1"}], ",", 
    RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", "10"}], "}"}]}], ",", 
    RowBox[{"DataRange", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", 
         RowBox[{"-", "0.05"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotTheme", "\[Rule]", "\"\<Scientific\>\""}], ",", 
    RowBox[{"AspectRatio", "->", "1"}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "\[Rule]", "\"\<Times New Roman\>\""}], ",", 
       "25", ",", 
       RowBox[{"GrayLevel", "[", "0", "]"}]}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontFamily", "->", "\"\<Times New Roman\>\""}], ",", "25"}], 
      "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Im \[Omega]\>\"", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Re \[Omega]\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.20"}], ",", "\"\<-0.20\>\""}], "}"}], ",", 
           RowBox[{"-", "0.15"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.10"}], ",", "\"\<-0.10\>\""}], "}"}], ",", 
           RowBox[{"-", "0.05"}]}], "}"}], ",", "Automatic"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "390"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.944192744597268*^9, 3.9441927448723125`*^9}, {
   3.9441931621717896`*^9, 3.944193191213496*^9}, {3.9441933099225845`*^9, 
   3.944193313013722*^9}, {3.9443417721686764`*^9, 3.944341783440875*^9}, {
   3.9443420911173525`*^9, 3.944342093417594*^9}, {3.944441863218051*^9, 
   3.9444418671035824`*^9}, 3.948415943161132*^9, {3.948923444259593*^9, 
   3.9489234471031075`*^9}, {3.948924513855637*^9, 3.948924516501217*^9}, {
   3.9489409022518396`*^9, 3.948940903293146*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"fd5f8677-43d4-406c-b834-506754447b0d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"A3b", ",", "A3a"}], "]"}]], "Input",
 CellChangeTimes->{{3.9489406859526796`*^9, 3.948940701183837*^9}, {
  3.948941521879465*^9, 3.948941524463916*^9}, {3.9489415775348873`*^9, 
  3.9489415787689314`*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"033c2424-17b4-4be8-b1b2-cfdfc99352fb"]
},
WindowSize->{949, 461},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 23, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"223dabb3-3458-4b20-b81c-c8a816bb010d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 172, 3, 28, "Input",ExpressionUUID->"b4eaf46f-7f99-4b5f-b5dd-2c2436f00ad4"],
Cell[733, 25, 883, 24, 48, "Input",ExpressionUUID->"48f2e14c-50bb-4e16-944d-eee860ce830f"],
Cell[1619, 51, 1052, 29, 67, "Input",ExpressionUUID->"f28b7ea3-5e66-4067-a97b-87304d51177e"],
Cell[2674, 82, 3212, 87, 181, "Input",ExpressionUUID->"ceddbec9-a7d2-4cf8-a50b-7408391ec6b2"],
Cell[5889, 171, 645, 16, 67, "Input",ExpressionUUID->"ea83d68d-3676-4e17-ba55-09c5095c901a"],
Cell[6537, 189, 423, 10, 48, "Input",ExpressionUUID->"24737c32-5b94-4d0f-b7d3-a979b1702144"],
Cell[6963, 201, 1645, 52, 67, "Input",ExpressionUUID->"2c1e12d4-ef2c-42e6-a659-f1767c569a81"],
Cell[8611, 255, 595, 14, 48, "Input",ExpressionUUID->"e59a3506-1e39-449c-8f48-97b68649e742"],
Cell[9209, 271, 926, 26, 48, "Input",ExpressionUUID->"4d3a9b87-fb03-44e1-9bfd-fe3175dfe8db"],
Cell[CellGroupData[{
Cell[10160, 301, 3041, 77, 143, "Input",ExpressionUUID->"1345b085-ca4c-4352-9504-769363700723"],
Cell[13204, 380, 5781, 119, 382, "Output",ExpressionUUID->"b6b32ece-c909-4295-be96-9c497bb2df6b"]
}, Open  ]],
Cell[19000, 502, 168, 2, 48, "Input",ExpressionUUID->"c6eb90e2-4303-46f4-acfc-d06dc2ab1f3b"],
Cell[19171, 506, 733, 23, 28, "Input",ExpressionUUID->"93061404-95b6-43b9-b963-f485d7f98677"],
Cell[19907, 531, 650, 20, 28, "Input",ExpressionUUID->"6488790d-3de0-4b0e-b658-efc64711adbb"],
Cell[20560, 553, 1931, 45, 67, "Input",ExpressionUUID->"d8dd481c-3876-4dee-925d-98731fde896c"],
Cell[22494, 600, 638, 17, 28, "Input",ExpressionUUID->"0d3dedf8-526c-47cf-9a85-a12508cdb5ab"],
Cell[23135, 619, 2626, 66, 124, "Input",ExpressionUUID->"fd5f8677-43d4-406c-b834-506754447b0d"],
Cell[25764, 687, 337, 7, 28, "Input",ExpressionUUID->"033c2424-17b4-4be8-b1b2-cfdfc99352fb"]
}
]
*)

